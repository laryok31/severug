{% extends "base.html" %}

{% block title %}–ü–æ–¥–∫–ª—é—á–∏—Ç—å Telegram{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body text-center p-5">
                <div class="display-1 mb-4">
                    <i class="bi bi-telegram" style="color: #0088cc;"></i>
                </div>

                <h2 class="mb-4">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ Telegram</h2>

                <p class="lead mb-4">
                    –ü–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–∫–∞—Ö, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è—Ö –∏ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø—Ä—è–º–æ –≤ Telegram!
                </p>

                <div class="alert alert-info mb-4">
                    <h5>üì± –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å:</h5>
                    <ol class="text-start">
                        <li class="mb-2">
                            –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞
                        </li>
                        <li class="mb-2">
                            –ù–∞–∂–º–∏—Ç–µ "Start" –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É <strong>/start</strong>
                        </li>
                        <li class="mb-2">
                            –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –±–æ—Ç—É
                        </li>
                    </ol>
                </div>

                <!-- –ö–æ–¥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
                <div class="display-4 mb-4 p-4 bg-light rounded" style="font-size: 3rem; letter-spacing: 10px; font-family: monospace;">
                    <strong>{{ code }}</strong>
                </div>

                <div class="alert alert-warning">
                    <i class="bi bi-info-circle"></i>
                    –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –±–æ—Ç—É –≤ Telegram.
                </div>

                <div class="mt-4">
                    <a href="https://t.me/{{ bot_username }}" target="_blank" class="btn btn-primary btn-lg">
                        <i class="bi bi-telegram"></i> –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ @{{ bot_username }}
                    </a>
                    <button class="btn btn-outline-secondary btn-lg mt-2" onclick="copyCode()">
                        <i class="bi bi-clipboard"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
                    </button>
                    <a href="/profile" class="btn btn-outline-secondary btn-lg mt-2">
                        <i class="bi bi-arrow-left"></i> –ù–∞–∑–∞–¥
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function copyCode() {
        const code = '{{ code }}';
        navigator.clipboard.writeText(code).then(() => {
            alert('‚úÖ –ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –±–æ—Ç—É');
        });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
    function checkConnection() {
        fetch('/api/check_telegram_connection')
            .then(response => response.json())
            .then(data => {
                if (data.connected) {
                    alert('‚úÖ Telegram —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                    window.location.href = '/profile';
                }
            });
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
    setInterval(checkConnection, 5000);
</script>
{% endblock %}